<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kofile — Vendor Tour Request</title>
  <style>
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }
      label {
        font-weight: 500;
      }
      input, textarea {
        border-radius: 6px;
        border: 1px solid #444;
        padding: 0.5rem;
        background-color: #111;
        color: #eee;
      }
    :root {
      --bg: #0d1117;
      --panel: #161b22;
      --border: #30363d;
      --text: #c9d1d9;
      --muted: #8b949e;
      --accent: #3b82f6;
      --ok: #22c55e;
      --err: #ef4444;
    }
    * { box-sizing: border-box; }
    html,body { height:100%; background:var(--bg); color:var(--text); font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,"Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji"; }
    a { color: var(--accent); }
    .wrap { max-width: 880px; margin: 48px auto; padding: 0 20px; }
    header { margin-bottom: 20px; }
    h1 { margin: 0 0 6px; font-size: 28px; }
    .sub { color: var(--muted); }
    .card { background: var(--panel); border: 1px solid var(--border); border-radius: 14px; padding: 24px; box-shadow: 0 10px 30px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.02); }
    form { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
    .row-1 { grid-column: 1 / -1; }
    label { display:block; font-weight:600; margin: 2px 0 8px; }
    input, textarea { width: 100%; background: #0b1220; color: var(--text); border: 1px solid var(--border); border-radius: 10px; padding: 12px 14px; outline: none; transition: border-color .15s ease, box-shadow .15s ease; }
    input:focus, textarea:focus { border-color: var(--accent); box-shadow: 0 0 0 3px rgba(59,130,246,.25); }
    textarea { min-height: 110px; resize: vertical; }
    .actions { grid-column: 1 / -1; display:flex; gap:12px; justify-content:flex-end; margin-top: 4px; }
    button { background: linear-gradient(90deg,#2563eb,#3b82f6); color:white; border:none; padding:12px 18px; border-radius:10px; cursor:pointer; font-weight:600; transition:transform .06s ease,filter .2s ease; }
    button:hover { filter:brightness(1.05); }
    button:active { transform:translateY(1px); }
    .ghost { background:transparent; border:1px solid var(--border); color:var(--text); }
    .status { grid-column:1/-1; margin-top:8px; border-radius:10px; padding:12px 14px; background:#0b1220; border:1px solid var(--border); color:var(--muted); display:none; }
    .status.ok { display:block; border-color:rgba(34,197,94,.35); color:#a7f3d0; background:rgba(34,197,94,.08); }
    .status.err { display:block; border-color:rgba(239,68,68,.35); color:#fecaca; background:rgba(239,68,68,.08); }
    .status.info { display:block; border-color:rgba(59,130,246,.35); color:#bfdbfe; background:rgba(59,130,246,.08); }
    footer { margin-top:22px; color:var(--muted); text-align:center; font-size:13px; }
  </style>
</head>
<body>
  <div class="wrap">
<header>
  <div class="header" style="text-align:center; margin-bottom: 1.5rem;">
    <img src="https://kofile.com/wp-content/uploads/2021/04/Kofile-RGB-onLight.svg" alt="Kofile Logo" style="height:60px; margin-bottom: 10px;">
    <h1 style="font-size:1.75rem; font-weight:600;">Request a Dallas Onsite Tour</h1>
    <p style="color:#ccc;">Submit your details — our team will review and confirm your onsite visit.</p>
  </div>
</header>

    <section class="card">
      <form id="tourForm" novalidate>
        <div class="row-1">
          <label for="Company">Company</label>
          <input id="Company" name="Company" required />
        </div>
        <div>
          <label for="RequesterName">Requester name</label>
          <input id="RequesterName" name="RequesterName" required />
        </div>
        <div>
          <label for="RequesterEmail">Requester email</label>
          <input id="RequesterEmail" name="RequesterEmail" type="email" required />
        </div>
        <div>
          <label for="Phone">Requester phone</label>
          <input id="Phone" name="Phone" type="tel" placeholder="(555) 555-0123" />
        </div>
        <div>
          <label for="PartySize">Party size</label>
          <input id="PartySize" name="PartySize" type="number" min="1" step="1" value="1" required />
        </div>
        <div>
          <label for="PreferredStart">Preferred start (local)</label>
          <input id="PreferredStart" name="PreferredStart" type="datetime-local" required />
        </div>
        <div>
          <label for="PreferredEnd">Preferred end (local)</label>
          <input id="PreferredEnd" name="PreferredEnd" type="datetime-local" required />
        </div>
        <div class="row-1">
          <label for="Reason">Notes / reason</label>
          <textarea id="Reason" name="Reason" placeholder="Share any context or requirements…"></textarea>
        </div>
        <div id="status" class="status"></div>
        <div class="actions">
          <button type="button" class="ghost" id="resetBtn">Reset</button>
          <button type="submit" id="submitBtn">Submit request</button>
        </div>
      </form>
    </section>

    <footer>© Kofile</footer>
  </div>

  <script>
    // === CONFIG ===
    // index.html (or your JS)
    const ENDPOINT = "https://apim-tourscheduler-sbx.azure-api.net/tours/book";



    const form = document.getElementById('tourForm');
    const statusEl = document.getElementById('status');
    const resetBtn = document.getElementById('resetBtn');
    const submitBtn = document.getElementById('submitBtn');
    const Phone = document.getElementById('Phone').value.trim();
    const toUtcIso = local => local ? new Date(local).toISOString() : '';

    function show(msg, cls='info') {
      statusEl.textContent = msg;
      statusEl.className = 'status ' + cls;
    }

    resetBtn.addEventListener('click', () => {
      form.reset();
      statusEl.className = 'status';
      statusEl.textContent = '';
    });

    form.addEventListener('submit', async e => {
      e.preventDefault();

      const payload = {
        company: document.getElementById('Company').value.trim(),
        requesterName: document.getElementById('RequesterName').value.trim(),
        requesterEmail: document.getElementById('RequesterEmail').value.trim(),
        phone: Phone,
        partySize: document.getElementById('PartySize').value.trim(),
        // Convert local datetime to UTC ISO format
        const StartUtc = new Date(document.getElementById('PreferredStart').value).toISOString();
        const EndUtc = new Date(document.getElementById('PreferredEnd').value).toISOString();

        reason: document.getElementById('Reason').value.trim()
      };

      if (!payload.company || !payload.requesterName || !payload.requesterEmail || !payload.startUtc || !payload.endUtc) {
        show('Please fill all required fields.', 'err');
        return;
      }

      submitBtn.disabled = true;
      show('Submitting...', 'info');

      try {
        const res = await fetch(ENDPOINT, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        let text = await res.text();
        let data = {};
        try { data = JSON.parse(text); } catch {}
        if (!res.ok) show(`Oops: ${data.message || res.statusText}`, 'err');
        else show('Request received — we’ll confirm by email soon.', 'ok');
      } catch (err) {
        show(`Network error: ${err.message}`, 'err');
      } finally {
        submitBtn.disabled = false;
      }
    });
<!-- Phone field (make sure the id matches) -->
<input id="RequesterPhone"
       name="RequesterPhone"
       type="tel"
       inputmode="tel"
       autocomplete="tel"
       placeholder="(555) 555-0123"
       maxlength="14" />

<script>
// Ensure DOM is loaded if this script isn't at the bottom
document.addEventListener('DOMContentLoaded', () => {
  const phone = document.getElementById('RequesterPhone');
  if (!phone) return; // field not on this page

  // Format "(123) 456-7890"
  function formatPhone(digits) {
    const d = digits.replace(/\D/g, '').slice(0, 10);
    if (!d) return '';
    if (d.length < 4) return `(${d}`;
    if (d.length < 7) return `(${d.slice(0,3)}) ${d.slice(3)}`;
    return `(${d.slice(0,3)}) ${d.slice(3,6)}-${d.slice(6)}`;
  }

  // Reformat as the user types, keep caret position natural
  function reformat(e) {
    const el = e.target;
    const before = el.value;
    const start = el.selectionStart ?? before.length;

    const digits = before.replace(/\D/g, '').slice(0,10);
    const after = formatPhone(digits);

    // If nothing changed, do nothing
    if (after === before) return;

    // Estimate caret movement
    const delta = after.length - before.length;
    el.value = after;

    // Put caret in a sensible place
    let pos = start + delta;
    pos = Math.max(0, Math.min(after.length, pos));
    try { el.setSelectionRange(pos, pos); } catch (_) {}
  }

  // Paste support (strip non-digits and format)
  phone.addEventListener('paste', (e) => {
    e.preventDefault();
    const pasted = (e.clipboardData || window.clipboardData).getData('text') || '';
    phone.value = formatPhone(pasted);
  });

  // Typing support
  phone.addEventListener('input', reformat);

  // Simple validity on blur (10 digits required)
  phone.addEventListener('blur', () => {
    const digits = phone.value.replace(/\D/g, '');
    if (digits.length !== 10) {
      phone.style.borderColor = 'red';
      phone.setCustomValidity('Phone number must be 10 digits');
    } else {
      phone.style.borderColor = '';
      phone.setCustomValidity('');
    }
  });
});
</script>
</body>
</html>
